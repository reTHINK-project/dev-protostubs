System.register([],function(e){return{execute:function(){e(function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=2)}({2:function(e,t,o){"use strict";o.r(t);let n={clientID:"000000004C18391F",redirectURI:location.origin,tokenEndpoint:"https://login.live.com/oauth20_authorize.srf?",type:"token",scope:"wl.signin,wl.basic",mode:"fragment"},r={validateAssertion:(e,t)=>new Promise(function(t,o){let n=JSON.parse(atob(e));t({identity:n.email,contents:n.nonce})}),generateAssertion:(e,t,o)=>new Promise(function(t,r){if(o){let e=o.split("/")[3].split("."),n=JSON.parse(atob(e[1])),r={domain:"microsoft.com",protocol:"OIDC"};t({assertion:e[1],idp:r,infoToken:n})}else{let t=n;r({name:"IdPLoginError",loginUrl:t.tokenEndpoint+"response_type="+t.type+"&client_id="+t.clientID+"&scope="+t.scope+"&nonce="+e+"&response_mode="+t.mode+"&redirect_uri="+t.redirectURI})}})};const s={name:"MicrosoftProxyStub",language:"javascript",description:"IDPProxy for microsoft idp",signature:"",configuration:{},constraints:{browser:!0},interworking:!1,objectName:"microsoft.com"};t.default=class{constructor(){}_start(e,t,o){let n=this;n.runtimeProtoStubURL=e,n.messageBus=t,n.config=o,n.messageBus.addListener("*",function(e){"domain-idp://microsoft.com"===e.to&&n.requestToIdp(e)}),n._sendStatus("created")}get descriptor(){return s}get name(){return s.name}requestToIdp(e){let t=this,o=e.body.params;switch(e.body.method){case"generateAssertion":r.generateAssertion(o.contents,o.origin,o.usernameHint).then(function(o){t.replyMessage(e,o)},function(o){t.replyMessage(e,o)});break;case"validateAssertion":r.validateAssertion(o.assertion,o.origin).then(function(o){t.replyMessage(e,o)},function(o){t.replyMessage(e,o)})}}replyMessage(e,t){let o={id:e.id,type:"response",to:e.from,from:e.to,body:{code:200,value:t}};this.messageBus.postMessage(o)}_sendStatus(e,t){console.log("[GoogleIdpProxy.sendStatus] ",e),this._state=e;let o={type:"update",from:this.runtimeProtoStubURL,to:this.runtimeProtoStubURL+"/status",body:{value:e}};t&&(o.body.desc=t),this.messageBus.postMessage(o)}}}}))}}});